;==============================================================
;
; TASKS PROVIDED FOR LOST TO THE ZONE: MORTAL SIN
;	Anomaly 1.5 - Lost to the Zone: Mortal Sin
;
;	Made by: SarisKhan
;	Last revised: 20 August 2020
;
;==============================================================

;=================Mortal Sin Storyline Quests===========================
; Mortal Sin Task 1-
[lttz_ms_start_dolg]
icon = ui_iconsTotal_bar_crazy_veterans_quest
prior = 195
storyline = true

title = lttz_ms_start_title
target = {+greh_envoy_dead} bar_dolg_leader, {+mortal_sin_envoy} bar_dolg_leader, bar_greh_envoy
descr = {+greh_envoy_dead} lttz_ms_start_dolg_descr_kill, {+mortal_sin_envoy} lttz_ms_start_dolg_descr_talk, lttz_ms_start_dolg_descr

on_init = %=reward_item(shovel_mili) =create_squad(bar_greh_envoy_squad:bar_visitors)%
on_complete = %=reward_money(5000) =complete_task_inc_goodwill(50:dolg) =give_task(lttz_ms_red_forester)%
condlist_0 = {+mortal_sin_red_forest} complete
condlist_1 = {-mortal_sin_envoy_complete +greh_envoy_dead} fail

[lttz_ms_start_killer]
icon = ui_iconsTotal_bar_crazy_veterans_quest
prior = 195
storyline = true

title = lttz_ms_start_title
target = {+greh_envoy_dead} cit_killers_merc_trader_stalker, {+mortal_sin_envoy} cit_killers_merc_trader_stalker, cit_greh_envoy
descr = {+greh_envoy_dead} lttz_ms_start_killer_descr_kill, {+mortal_sin_envoy} lttz_ms_start_killer_descr_talk, lttz_ms_start_killer_descr

on_init = %=reward_item(shovel_mili) =create_squad(cit_greh_envoy_squad:cit_killers)%
on_complete = %=reward_money(5000) =complete_task_inc_goodwill(50:killer) =give_task(lttz_ms_red_forester)%
condlist_0 = {+mortal_sin_red_forest} complete
condlist_1 = {-mortal_sin_envoy_complete +greh_envoy_dead} fail

[lttz_ms_start_stalker]
icon = ui_iconsTotal_bar_crazy_veterans_quest
prior = 195
storyline = true

title = lttz_ms_start_title
target = {+greh_envoy_dead} esc_m_trader, {+mortal_sin_envoy} esc_m_trader, esc_greh_envoy
descr = {+greh_envoy_dead} lttz_ms_start_stalker_descr_kill, {+mortal_sin_envoy} lttz_ms_start_stalker_descr_talk, lttz_ms_start_stalker_descr

on_init = %=reward_item(shovel_old) =create_squad(esc_greh_envoy_squad:esc_smart_terrain_2_12)%
on_complete = %=reward_money(5000) =reward_stash(true) =complete_task_inc_goodwill(50:stalker) =give_task(lttz_ms_red_forester)%
condlist_0 = {+mortal_sin_red_forest} complete
condlist_1 = {-mortal_sin_envoy_complete +greh_envoy_dead} fail

[lttz_ms_start_csky]
icon = ui_iconsTotal_bar_crazy_veterans_quest
prior = 195
storyline = true

title = lttz_ms_start_title
target = {+greh_envoy_dead} mar_smart_terrain_base_stalker_leader_marsh, {+mortal_sin_envoy} mar_smart_terrain_base_stalker_leader_marsh, mar_greh_envoy
descr = {+greh_envoy_dead} lttz_ms_start_csky_descr_kill, {+mortal_sin_envoy} lttz_ms_start_csky_descr_talk, lttz_ms_start_csky_descr

on_init = %=reward_item(shovel_mili) =create_squad(mar_greh_envoy_squad:mar_smart_terrain_base)%
on_complete = %=reward_money(5000) =reward_stash(true) =complete_task_inc_goodwill(50:csky) =give_task(lttz_ms_red_forester)%
condlist_0 = {+mortal_sin_red_forest} complete
condlist_1 = {-mortal_sin_envoy_complete +greh_envoy_dead} fail

[lttz_ms_start_freedom]
icon = ui_iconsTotal_bar_crazy_veterans_quest
prior = 195
storyline = true

title = lttz_ms_start_title
target = {+greh_envoy_dead} mil_smart_terrain_7_7_freedom_leader_stalker, {+mortal_sin_envoy} mil_smart_terrain_7_7_freedom_leader_stalker, mil_greh_envoy
descr = {+greh_envoy_dead} lttz_ms_start_freedom_descr_kill, {+mortal_sin_envoy} lttz_ms_start_freedom_descr_talk, lttz_ms_start_freedom_descr

on_init = %=reward_item(shovel_mili) =create_squad(mil_greh_envoy_squad:mil_smart_terrain_7_7)%
on_complete = %=reward_money(5000) =reward_stash(true) =complete_task_inc_goodwill(50:freedom) =give_task(lttz_ms_red_forester)%
condlist_0 = {+mortal_sin_red_forest} complete
condlist_1 = {-mortal_sin_envoy_complete +greh_envoy_dead} fail

[lttz_ms_start_ecolog]
icon = ui_iconsTotal_bar_crazy_veterans_quest
prior = 195
storyline = true

title = lttz_ms_start_title
target = {+greh_envoy_dead} yan_stalker_sakharov, {+mortal_sin_envoy} yan_stalker_sakharov, yan_greh_envoy
descr = {+greh_envoy_dead} lttz_ms_start_ecolog_descr_kill, {+mortal_sin_envoy} lttz_ms_start_ecolog_descr_talk, lttz_ms_start_ecolog_descr

on_init = %=create_squad(yan_greh_envoy_squad:yan_smart_terrain_6_4)%
on_complete = %=reward_money(5000) =complete_task_inc_goodwill(50:ecolog) =give_task(lttz_ms_red_forester)%
condlist_0 = {+mortal_sin_red_forest} complete
condlist_1 = {-mortal_sin_envoy_complete +greh_envoy_dead} fail

;------------------------------------------------
; Mortal Sin Task 2-
[lttz_ms_red_forester]
icon = ui_inGame2_Put_v_pripyat
prior = 195
storyline = true

title = lttz_ms_red_forester_title
target = red_forester_tech
descr = lttz_ms_red_forester_descr

on_complete = %=give_task(lttz_ms_red_forest_attackers) =clear_smart_terrain(red_smart_terrain_6_3)%
condlist_0 = {+red_forester_mortal_sin} complete

;------------------------------------------------
; Mortal Sin Task 3-
[lttz_ms_red_forest_attackers]
icon = ui_inGame2_PD_Lider
prior = 195
storyline = true

title = lttz_ms_red_forest_attackers_title
target_functor = task_targets_lostzone_all
descr = {+red_forest_greh_squad_dead} lttz_ms_red_forest_attackers_descr2, lttz_ms_red_forest_attackers_descr

on_init = %=create_squad(red_forest_greh_squad:red_smart_terrain_6_3)%
on_complete = %=give_task(lttz_ms_runaway) +forest_haunters_done%
condlist_0 = {+red_forest_greh_squad_dead =actor_has_item(attackers_pda)} complete

;------------------------------------------------
; Mortal Sin Task 4-
[lttz_ms_runaway]
icon = ui_inGame2_Issledovatelskaya_gruppa
prior = 195
storyline = true

title = lttz_ms_runaway_title
target_functor = task_targets_lostzone_all
descr = lttz_ms_runaway_descr

on_init = %=clear_smart_terrain(red_smart_terrain_3_2:true) =create_squad(stalker_stitch_ms_squad:red_smart_terrain_3_2)%
on_complete = %=reward_money(5000) =reward_item(yadylin) =complete_task_inc_goodwill(50:stalker) =give_task(lttz_ms_needle_haystack)%
condlist_0 = {+stalker_stitch_mortal_sin} complete
condlist_1 = {+stalker_stitch_dead} fail

;------------------------------------------------
; Mortal Sin Task 5-
[lttz_ms_needle_haystack]
icon = ui_iconsTotal_yan_find_scientist
prior = 195
storyline = true

title = lttz_ms_needle_haystack_title
target_functor = task_targets_lostzone_all
status_functor = special_steps_for_lostzone_tasks
descr = {=actor_has_item(stitch_decoder)} lttz_ms_return_stitch_descr, lttz_ms_needle_haystack_descr
stage_complete = 2

on_init = %=spawn_stitch_decoder()%
on_complete = %=reward_item(stimpack_army) =reward_stash(true) =complete_task_inc_goodwill(50:stalker) =remove_special_task_squad(stalker_stitch)%
condlist_0 = {+stalker_stitch_mortal_sin_decoder} complete
condlist_1 = {+stalker_stitch_dead} fail

;------------------------------------------------
; Mortal Sin Task 6-
[lttz_ms_report_dolg]
icon = ui_iconsNpc_stalker_do_komandir
prior = 195
storyline = true

title = lttz_ms_report_title
target = bar_dolg_leader
descr = lttz_ms_report_dolg_descr

on_init = %=remove_squad(bar_greh_envoy)%
on_complete = %=reward_money(5000) =complete_task_inc_goodwill(50:dolg)%
condlist_0 = {+mortal_sin_report} complete

[lttz_ms_report_killer]
icon = ui_iconsNpc_stalker_ki_informator
prior = 195
storyline = true

title = lttz_ms_report_title
target = cit_killers_merc_trader_stalker
descr = lttz_ms_report_killer_descr

on_init = %=remove_squad(cit_greh_envoy)%
on_complete = %=reward_money(5000) =complete_task_inc_goodwill(50:killer)%
condlist_0 = {+mortal_sin_report} complete

[lttz_ms_report_stalker]
icon = ui_iconsNpc_trader
prior = 195
storyline = true

title = lttz_ms_report_title
target = esc_m_trader
descr = lttz_ms_report_stalker_descr

on_init = %=remove_squad(esc_greh_envoy)%
on_complete = %=reward_money(5000) =complete_task_inc_goodwill(50:stalker)%
condlist_0 = {+mortal_sin_report} complete

[lttz_ms_report_csky]
icon = ui_inGame2_Put_v_pripyat
prior = 195
storyline = true

title = lttz_ms_report_title
target = mar_smart_terrain_base_stalker_leader_marsh
descr = lttz_ms_report_csky_descr

on_init = %=remove_squad(mar_greh_envoy)%
on_complete = %=reward_money(5000) =complete_task_inc_goodwill(50:csky)%
condlist_0 = {+mortal_sin_report} complete

[lttz_ms_report_freedom]
icon = ui_iconsNpc_stalker_sv_leader
prior = 195
storyline = true

title = lttz_ms_report_title
target = mil_smart_terrain_7_7_freedom_leader_stalker
descr = lttz_ms_report_freedom_descr

on_init = %=remove_squad(mil_greh_envoy)%
on_complete = %=reward_money(5000) =complete_task_inc_goodwill(50:freedom)%
condlist_0 = {+mortal_sin_report} complete

[lttz_ms_report_ecolog]
icon = ui_iconsNpc_ucheniy_2
prior = 195
storyline = true

title = lttz_ms_report_title
target = yan_stalker_sakharov
descr = lttz_ms_report_ecolog_descr

on_init = %=remove_squad(yan_greh_envoy)%
on_complete = %=reward_money(5000) =complete_task_inc_goodwill(50:ecolog)%
condlist_0 = {+mortal_sin_report} complete

;------------------------------------------------
; Mortal Sin Task 7-
[lttz_ms_ambush_dolg]
icon = ui_iconsTotal_defend_lager
prior = 195
storyline = true

title = lttz_ms_ambush_title
target = {+greh_ambush_squad_dead} bar_dolg_leader, greh_ambush_squad
descr = {+greh_ambush_squad_dead} lttz_ms_ambush_dolg_done_descr, lttz_ms_ambush_dolg_descr

on_init = %=create_squad(bar_greh_ambush_squad:bar_zastava_2)%
on_complete = %=reward_random_money(7000:8000) =reward_item(energy_drink) =complete_task_inc_goodwill(50:dolg)%
condlist_0 = {+mortal_sin_ambush} complete

[lttz_ms_ambush_killer]
icon = ui_iconsTotal_defend_lager
prior = 195
storyline = true

title = lttz_ms_ambush_title
target = {+greh_ambush_squad_dead} cit_killers_merc_trader_stalker, greh_ambush_squad
descr = {+greh_ambush_squad_dead} lttz_ms_ambush_killer_done_descr, lttz_ms_ambush_killer_descr

on_init = %=create_squad(cit_greh_ambush_squad:cit_killers_2)%
on_complete = %=reward_random_money(7000:8000) =reward_item(energy_drink) =complete_task_inc_goodwill(50:killer)%
condlist_0 = {+mortal_sin_ambush} complete

[lttz_ms_ambush_stalker]
icon = ui_iconsTotal_defend_lager
prior = 195
storyline = true

title = lttz_ms_ambush_title
target = {+greh_ambush_squad_dead} esc_m_trader, greh_ambush_squad
descr = {+greh_ambush_squad_dead} lttz_ms_ambush_stalker_done_descr, lttz_ms_ambush_stalker_descr

on_init = %=create_squad(esc_greh_ambush_squad:esc_smart_terrain_4_11)%
on_complete = %=reward_random_money(7000:7500) =reward_item(beer) =reward_stash(true) =complete_task_inc_goodwill(50:stalker)%
condlist_0 = {+mortal_sin_ambush} complete

[lttz_ms_ambush_csky]
icon = ui_iconsTotal_defend_lager
prior = 195
storyline = true

title = lttz_ms_ambush_title
target = {+greh_ambush_squad_dead} mar_smart_terrain_base_stalker_leader_marsh, greh_ambush_squad
descr = {+greh_ambush_squad_dead} lttz_ms_ambush_csky_done_descr, lttz_ms_ambush_csky_descr

on_init = %=create_squad(mar_greh_ambush_squad:mar_smart_terrain_5_12)%
on_complete = %=reward_random_money(7000:7500) =reward_item(vodka_quality) =reward_stash(true) =complete_task_inc_goodwill(50:csky)%
condlist_0 = {+mortal_sin_ambush} complete

[lttz_ms_ambush_freedom]
icon = ui_iconsTotal_defend_lager
prior = 195
storyline = true

title = lttz_ms_ambush_title
target = {+greh_ambush_squad_dead} mil_smart_terrain_7_7_freedom_leader_stalker, greh_ambush_squad
descr = {+greh_ambush_squad_dead} lttz_ms_ambush_freedom_done_descr, lttz_ms_ambush_freedom_descr

on_init = %=create_squad(mil_greh_ambush_squad:mil_smart_terrain_7_8)%
on_complete = %=reward_random_money(7000:7500) =reward_item(vodka_quality) =reward_stash(true) =complete_task_inc_goodwill(50:freedom)%
condlist_0 = {+mortal_sin_ambush} complete

[lttz_ms_ambush_ecolog]
icon = ui_iconsTotal_defend_lager
prior = 195
storyline = true

title = lttz_ms_ambush_title
target = {+greh_ambush_squad_dead} yan_stalker_sakharov, greh_ambush_squad
descr = {+greh_ambush_squad_dead} lttz_ms_ambush_ecolog_done_descr, lttz_ms_ambush_ecolog_descr

on_init = %=create_squad(yan_greh_ambush_squad:yan_smart_terrain_5_3)%
on_complete = %=reward_random_money(7000:7500) =reward_item(drug_psy_blockade) =complete_task_inc_goodwill(50:ecolog)%
condlist_0 = {+mortal_sin_ambush} complete

;------------------------------------------------
; Dark Crusade Mortal Sin Task-
[lttz_ms_dark_crusade]
icon = ui_icons_base_attack24
prior = 195
storyline = true

title = lttz_ms_dark_crusade_title
target = {+stalker_rogue_mortal_sin_contact_lost -stalker_rogue_mortal_sin_ready} stalker_rogue
descr = {+kat_greh_sabaoth_mortal_sin} lttz_ms_dark_crusade_descr2, lttz_ms_dark_crusade_descr

condlist_0 = {+mortal_sin_endgame} complete
condlist_1 = {+stalker_rogue_dead} fail, {+stalker_stitch_dead} fail, {+too_late} fail

;------------------------------------------------
; Mortal Sin Task 8-

-- Miracle Machine
[lttz_ms_protect_miracle_machine]
icon = ui_iconsTotal_yan_kill_brain_task
prior = 195
storyline = true

title = lttz_ms_preemptive_strike_title
target = {+yan_greh_miracle_squad_2_dead} yan_greh_miracle_squad_3, {+yan_greh_miracle_squad_1_dead} yan_greh_miracle_squad_2, yan_greh_miracle_squad_1
descr = {+yan_greh_miracle_squad_2_dead} lttz_ms_protect_miracle_machine_descr3, {+yan_greh_miracle_squad_1_dead} lttz_ms_protect_miracle_machine_descr2, lttz_ms_protect_miracle_machine_descr
status_functor = special_steps_for_lostzone_tasks
status_functor_params = 86400 ;1 day
stage_complete = 2

on_init = %=create_squad(yan_greh_miracle_squad_1:yan_smart_terrain_2_4) =create_squad(yan_greh_miracle_squad_2:x162_st_snork) =create_squad(yan_greh_miracle_squad_3:x162_st_burer) =clear_smart_terrain(lim_smart_terrain_1) =clear_smart_terrain(lim_smart_terrain_3)%
on_complete = %=give_task(lttz_ms_to_war) =erase_pstor_ctime(impending_doom_timer) =open_route(lim:cit) =open_route(lim:red) +psy_installation_defended%
on_fail = %-yan_labx16_switcher_primary_off =erase_pstor_ctime(impending_doom_timer)%
condlist_0 = {+yan_greh_miracle_squad_1_dead +yan_greh_miracle_squad_2_dead +yan_greh_miracle_squad_3_dead} complete
condlist_1 = {+too_late} fail

-- Brain Scorcher
[lttz_ms_protect_brain_scorcher]
icon = ui_iconsTotal_bar_radar_deactivate
prior = 195
storyline = true

title = lttz_ms_preemptive_strike_title
target = rad_greh_scorcher_squad
descr = lttz_ms_protect_brain_scorcher_descr
status_functor = special_steps_for_lostzone_tasks
status_functor_params = 172800 ;2 days
stage_complete = 2

on_init = %=create_squad(rad_greh_scorcher_squad:rad_antenna_patrol) =clear_smart_terrain(lim_smart_terrain_1) =clear_smart_terrain(lim_smart_terrain_3)%
on_complete = %=give_task(lttz_ms_to_war) =erase_pstor_ctime(impending_doom_timer) =open_route(lim:cit) =open_route(lim:red) +psy_installation_defended%
on_fail = %-bar_deactivate_radar_done =erase_pstor_ctime(impending_doom_timer)%
condlist_0 = {+rad_greh_scorcher_squad_dead} complete
condlist_1 = {+too_late} fail 

;------------------------------------------------
; Mortal Sin Task 9-
[lttz_ms_to_war]
icon = ui_inGame2_Put_v_pripyat
prior = 195
storyline = true

title = lttz_ms_to_war_title
target = stalker_rogue
descr = lttz_ms_to_war_descr

on_init = %=create_squad(stalker_rogue_ms_squad:lim_smart_terrain_1) =create_squad(lim_stalker_rogue_squad:lim_smart_terrain_1) =create_squad(lim_greh_assault_squad_1:lim_smart_terrain_4) =create_squad(lim_greh_assault_squad_2:lim_smart_terrain_5) =create_squad(lim_greh_assault_squad_3:lim_smart_terrain_6)%
condlist_0 = {+stalker_rogue_mortal_sin} complete
condlist_1 = {+stalker_rogue_dead} fail

;------------------------------------------------
; Mortal Sin Task 10-
[lttz_ms_urban_warfare_dolg]
icon = ui_icons_kill_stalker6
prior = 195
storyline = true

title = lttz_ms_urban_warfare_title
target = {+greh_castigator_3_dead} stalker_rogue, {+greh_castigator_2_dead} greh_castigator_3, {+greh_castigator_1_dead} greh_castigator_2, greh_castigator_1
descr = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead} lttz_ms_urban_warfare_descr2, lttz_ms_urban_warfare_descr

on_init = %=create_squad(lim_greh_recon_squad:lim_smart_terrain_3) =create_squad(lim_greh_forward_squad:lim_smart_terrain_3) =create_squad(greh_castigator_1_squad:lim_smart_terrain_4) =create_squad(greh_castigator_2_squad:lim_smart_terrain_5) =create_squad(greh_castigator_3_squad:lim_smart_terrain_6) =setup_companion_special_task(lim_dolg_assault_squad:lim_smart_terrain_1)%
on_complete = %=complete_task_inc_goodwill(50:stalker:dolg) =reward_random_money(9000:10000) =give_task(lttz_ms_war_prisoner)%
condlist_0 = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead +stalker_rogue_mortal_sin_warfare} complete
condlist_1 = {+stalker_rogue_dead} fail

[lttz_ms_urban_warfare_killer]
icon = ui_icons_kill_stalker6
prior = 195
storyline = true

title = lttz_ms_urban_warfare_title
target = {+greh_castigator_3_dead} stalker_rogue, {+greh_castigator_2_dead} greh_castigator_3, {+greh_castigator_1_dead} greh_castigator_2, greh_castigator_1
descr = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead} lttz_ms_urban_warfare_descr2, lttz_ms_urban_warfare_descr

on_init = %=create_squad(lim_greh_recon_squad:lim_smart_terrain_3) =create_squad(lim_greh_forward_squad:lim_smart_terrain_3) =create_squad(greh_castigator_1_squad:lim_smart_terrain_4) =create_squad(greh_castigator_2_squad:lim_smart_terrain_5) =create_squad(greh_castigator_3_squad:lim_smart_terrain_6) =setup_companion_special_task(lim_killer_assault_squad:lim_smart_terrain_1)%
on_complete = %=complete_task_inc_goodwill(50:stalker:killer) =reward_random_money(9000:10000) =give_task(lttz_ms_war_prisoner)%
condlist_0 = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead +stalker_rogue_mortal_sin_warfare} complete
condlist_1 = {+stalker_rogue_dead} fail

[lttz_ms_urban_warfare_stalker]
icon = ui_icons_kill_stalker6
prior = 195
storyline = true

title = lttz_ms_urban_warfare_title
target = {+greh_castigator_3_dead} stalker_rogue, {+greh_castigator_2_dead} greh_castigator_3, {+greh_castigator_1_dead} greh_castigator_2, greh_castigator_1
descr = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead} lttz_ms_urban_warfare_descr2, lttz_ms_urban_warfare_descr

on_init = %=create_squad(lim_greh_recon_squad:lim_smart_terrain_3) =create_squad(lim_greh_forward_squad:lim_smart_terrain_3) =create_squad(greh_castigator_1_squad:lim_smart_terrain_4) =create_squad(greh_castigator_2_squad:lim_smart_terrain_5) =create_squad(greh_castigator_3_squad:lim_smart_terrain_6) =setup_companion_special_task(lim_stalker_assault_squad:lim_smart_terrain_1)%
on_complete = %=complete_task_inc_goodwill(75:stalker) =reward_random_money(9000:10000) =give_task(lttz_ms_war_prisoner)%
condlist_0 = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead +stalker_rogue_mortal_sin_warfare} complete
condlist_1 = {+stalker_rogue_dead} fail

[lttz_ms_urban_warfare_csky]
icon = ui_icons_kill_stalker6
prior = 195
storyline = true

title = lttz_ms_urban_warfare_title
target = {+greh_castigator_3_dead} stalker_rogue, {+greh_castigator_2_dead} greh_castigator_3, {+greh_castigator_1_dead} greh_castigator_2, greh_castigator_1
descr = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead} lttz_ms_urban_warfare_descr2, lttz_ms_urban_warfare_descr

on_init = %=create_squad(lim_greh_recon_squad:lim_smart_terrain_3) =create_squad(lim_greh_forward_squad:lim_smart_terrain_3) =create_squad(greh_castigator_1_squad:lim_smart_terrain_4) =create_squad(greh_castigator_2_squad:lim_smart_terrain_5) =create_squad(greh_castigator_3_squad:lim_smart_terrain_6) =setup_companion_special_task(lim_csky_assault_squad:lim_smart_terrain_1)%
on_complete = %=complete_task_inc_goodwill(50:stalker:csky) =reward_random_money(9000:10000) =give_task(lttz_ms_war_prisoner)%
condlist_0 = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead +stalker_rogue_mortal_sin_warfare} complete
condlist_1 = {+stalker_rogue_dead} fail

[lttz_ms_urban_warfare_freedom]
icon = ui_icons_kill_stalker6
prior = 195
storyline = true

title = lttz_ms_urban_warfare_title
target = {+greh_castigator_3_dead} stalker_rogue, {+greh_castigator_2_dead} greh_castigator_3, {+greh_castigator_1_dead} greh_castigator_2, greh_castigator_1
descr = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead} lttz_ms_urban_warfare_descr2, lttz_ms_urban_warfare_descr

on_init = %=create_squad(lim_greh_recon_squad:lim_smart_terrain_3) =create_squad(lim_greh_forward_squad:lim_smart_terrain_3) =create_squad(greh_castigator_1_squad:lim_smart_terrain_4) =create_squad(greh_castigator_2_squad:lim_smart_terrain_5) =create_squad(greh_castigator_3_squad:lim_smart_terrain_6) =setup_companion_special_task(lim_freedom_assault_squad:lim_smart_terrain_1)%
on_complete = %=complete_task_inc_goodwill(50:stalker:freedom) =reward_random_money(9000:10000) =give_task(lttz_ms_war_prisoner)%
condlist_0 = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead +stalker_rogue_mortal_sin_warfare} complete
condlist_1 = {+stalker_rogue_dead} fail

[lttz_ms_urban_warfare_ecolog]
icon = ui_icons_kill_stalker6
prior = 195
storyline = true

title = lttz_ms_urban_warfare_title
target = {+greh_castigator_3_dead} stalker_rogue, {+greh_castigator_2_dead} greh_castigator_3, {+greh_castigator_1_dead} greh_castigator_2, greh_castigator_1
descr = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead} lttz_ms_urban_warfare_descr2, lttz_ms_urban_warfare_descr

on_init = %=create_squad(lim_greh_recon_squad:lim_smart_terrain_3) =create_squad(lim_greh_forward_squad:lim_smart_terrain_3) =create_squad(greh_castigator_1_squad:lim_smart_terrain_4) =create_squad(greh_castigator_2_squad:lim_smart_terrain_5) =create_squad(greh_castigator_3_squad:lim_smart_terrain_6) =setup_companion_special_task(lim_ecolog_assault_squad:lim_smart_terrain_1)%
on_complete = %=complete_task_inc_goodwill(50:stalker:ecolog) =reward_random_money(9000:10000) =give_task(lttz_ms_war_prisoner)%
condlist_0 = {+greh_castigator_1_dead +greh_castigator_2_dead +greh_castigator_3_dead +stalker_rogue_mortal_sin_warfare} complete
condlist_1 = {+stalker_rogue_dead} fail

;------------------------------------------------
; Mortal Sin Task 11-
[lttz_ms_war_prisoner]
icon = ui_inGame2_Zalozhnik
prior = 195
storyline = true

title = lttz_ms_war_prisoner_title
target = {+greh_prisoner_dialog} stalker_rogue, greh_prisoner
descr = lttz_ms_war_prisoner_descr

on_init = %=create_special_task_squad(greh_prisoner_squad:lim_smart_terrain_1)%
on_complete = %=complete_task_inc_goodwill(50:stalker) =reward_money(5000) =give_task(lttz_ms_contact_lost) =remove_special_task_squad(greh_prisoner) =clear_smart_terrain(lim_smart_terrain_8)%
condlist_0 = {+greh_prisoner_dialog +stalker_rogue_mortal_sin_interrogation} complete
condlist_1 = {-greh_prisoner_dialog +greh_prisoner_dead} fail
condlist_2 = {+stalker_rogue_dead} fail

;------------------------------------------------
; Mortal Sin Task 12-
[lttz_ms_contact_lost]
icon = ui_inGame2_Ohota_na_Krovososov
storyline = true
prior = 195

title = lttz_ms_contact_lost_title
descr = {=actor_has_item(contact_lost_pda) +lim_stalker_scout_dialog} lttz_ms_contact_lost_descr2, lttz_ms_contact_lost_descr
target = {=actor_has_item(contact_lost_pda) +lim_stalker_scout_dialog} stalker_rogue, lim_stalker_scout
status_functor = special_steps_for_lostzone_tasks
stage_complete = 5

on_init = %=spawn_contact_lost_pda() =create_squad(lim_stalker_scout_squad:lim_smart_terrain_8) =clear_smart_terrain(lim_smart_terrain_7)%
on_complete = %=reward_money(8000) =complete_task_inc_goodwill(50:stalker)%
condlist_0 = {+lim_stalker_scout_dialog +stalker_rogue_mortal_sin_contact_lost} complete
condlist_1 = {-lim_stalker_scout_dialog +lim_stalker_scout_dead} fail
condlist_2 = {+stalker_rogue_dead} fail

;------------------------------------------------
; Mortal Sin Task 13-
[lttz_ms_destruction_site]
icon = ui_icons_base_attack24
prior = 195
storyline = true

title = lttz_ms_destruction_site_title
target = {+lim_greh_outpost_squad_dead} stalker_rogue, lim_greh_outpost_squad
descr = lttz_ms_destruction_site_descr

on_init = %=create_squad(lim_greh_outpost_squad:lim_smart_terrain_9)%
on_complete = %=complete_task_inc_goodwill(50:stalker) =give_task(lttz_ms_hospital_assault) =open_route(lim:kat)%
condlist_0 = {+lim_greh_outpost_squad_dead +stalker_rogue_mortal_sin_destruction} complete
condlist_1 = {+stalker_rogue_dead} fail

;------------------------------------------------
; Mortal Sin Task 14-
[lttz_ms_hospital_assault]
icon = ui_inGame2_PD_Lider
prior = 195
storyline = true

title = lttz_ms_hospital_assault_title
target = {+kat_greh_sabaoth_mortal_sin} stalker_rogue, {+kat_greh_garrison_squad_dead +kat_greh_sabaoth_call} greh_sabaoth, {+lim_greh_remnant_squad_dead} kat_greh_garrison_squad, lim_greh_remnant_squad
descr = {+kat_greh_garrison_squad_dead +kat_greh_sabaoth_call} lttz_ms_hospital_assault_descr3, {+lim_greh_remnant_squad_dead} lttz_ms_hospital_assault_descr2, lttz_ms_hospital_assault_descr
status_functor = special_steps_for_lostzone_tasks
stage_complete = 6

on_init = %=create_squad(lim_greh_remnant_squad:lim_smart_terrain_10) =create_squad(kat_greh_garrison_squad:katacomb_smart_terrain) =create_squad(kat_greh_sabaoth_squad:katacomb_smart_terrain)%
on_complete = %=complete_task_inc_goodwill(50:stalker) =give_task(lttz_ms_heart_zone) =open_route(kat:aes2) =open_route(aes2:gen) =clear_smart_terrain(gen_smart_terrain_lab_entrance_2)%
condlist_0 = {+kat_greh_sabaoth_mortal_sin +stalker_rogue_mortal_sin_assault} complete
;--condlist_0 = {+lim_greh_remnant_squad_dead +kat_greh_garrison_squad_dead +kat_greh_sabaoth_mortal_sin +stalker_rogue_mortal_sin_assault} complete
condlist_1 = {+stalker_rogue_dead} fail

;------------------------------------------------
; Mortal Sin Task 15-
[lttz_ms_heart_zone]
icon = ui_inGame2_psi_storm
prior = 195
storyline = true

title = lttz_ms_heart_zone_title
target = {+ms_stitch_msg} stalker_stitch, {=actor_on_level(l13_generators) -ms_stitch_msg} nil, {+aes2_greh_squad2_dead} aes2_space_restrictor_to_gen, {+aes2_greh_squad1_dead} aes2_greh_squad2, aes2_greh_squad1
descr = {+ms_stitch_msg} lttz_ms_heart_zone_descr3, {+aes2_greh_squad1_dead +aes2_greh_squad2_dead} lttz_ms_heart_zone_descr2, lttz_ms_heart_zone_descr
status_functor = special_steps_for_lostzone_tasks
stage_complete = 2

on_init = %=create_squad(aes2_greh_squad1:aes2_monsters2) =create_squad(aes2_greh_squad2:aes2_monsters1) =create_squad(stalker_stitch_ms_gen_squad:gen_smart_terrain_lab_entrance_2)%
on_complete = %=complete_task_inc_goodwill(50:stalker) =give_task(lttz_ms_decisive_blow) =clear_smart_terrain(gen_smart_terrain_lab_entrance)%
condlist_0 = {+aes2_greh_squad1_dead +aes2_greh_squad2_dead +stalker_stitch_mortal_sin_generators} complete
condlist_1 = {+stalker_rogue_dead} fail, {+stalker_stitch_dead} fail

;------------------------------------------------
; Mortal Sin Task 16-
[lttz_ms_decisive_blow]
icon = ui_icons_base_attack24
prior = 195
storyline = true

title = lttz_ms_decisive_blow_title
target = gen_greh_ultimate_squad
descr = lttz_ms_decisive_blow_descr
status_functor = special_steps_for_lostzone_tasks
status_functor_params = 10800 ;3 hours
stage_complete = 2

on_init = %=create_squad(gen_greh_ultimate_squad:gen_smart_terrain_lab_entrance)%
on_complete = %=create_special_task_squad(gen_greh_sabaoth_squad:gen_smart_terrain_lab_entrance) =play_sound_on_actor(gimlet_teleport) =complete_task_inc_goodwill(50:stalker) =give_task(lttz_ms_confrontation) =erase_pstor_ctime(impending_doom_timer) +ms_decisive_blow%
on_fail = %=erase_pstor_ctime(impending_doom_timer)%
condlist_0 = {+gen_greh_ultimate_squad_dead} complete
condlist_1 = {+stalker_rogue_dead} fail, {+stalker_stitch_dead} fail

;------------------------------------------------
; Mortal Sin Task 17-
[lttz_ms_confrontation]
icon = ui_icons_base_attack24
prior = 195
storyline = true

title = lttz_ms_confrontation_title
target = greh_sabaoth
descr = lttz_ms_confrontation_descr
status_functor = special_steps_for_lostzone_tasks
stage_complete = 3

on_complete = %=remove_special_task_squad(greh_sabaoth) =play_sound_on_actor(gimlet_teleport) =clear_smart_terrain(aes2_monolith_camp1) =clear_smart_terrain(sar_monolith_guard) =give_task(lttz_ms_endgame)%
condlist_0 = {+gen_greh_sabaoth_mortal_sin_generators} complete
condlist_1 = {+stalker_rogue_dead} fail, {+stalker_stitch_dead} fail

;------------------------------------------------
; Mortal Sin Task 18-
[lttz_ms_endgame]
icon = ui_inGame2_PD_WishfulThinking
prior = 195
storyline = true

title = lttz_ms_endgame_title
target = {=actor_on_level(l13_generators)} gen_space_restrictor_to_aes2, {=actor_on_level(l12_stancia_2)} aes2_space_restrictor_to_secret_lab, {=actor_on_level(l12u_control_monolith) +greh_sabaoth_dead +greh_castigator_6_dead} greh_castigator_5, {=actor_on_level(l12u_control_monolith) +greh_sabaoth_dead +greh_castigator_5_dead} greh_castigator_6, {=actor_on_level(l12u_control_monolith) -greh_sabaoth_dead} sar_greh_sabaoth
descr = lttz_ms_endgame_descr
status_functor = special_steps_for_lostzone_tasks
status_functor_params = 21600 ;6 hours
stage_complete = 2

on_init = %=create_squad(aes2_greh_defence_squad:aes2_monolith_camp1) =create_squad(greh_castigator_5_squad:sar_monolith_guard) =create_squad(greh_castigator_6_squad:sar_monolith_guard) =create_squad(sar_greh_sabaoth_squad:sar_monolith_guard) =open_route(aes2:s_lab)%
on_complete = %=give_task(lttz_ms_choice) =complete_task_inc_goodwill(50:stalker) =erase_pstor_ctime(impending_doom_timer) +mortal_sin_endgame%
on_fail = %=erase_pstor_ctime(impending_doom_timer)%
condlist_0 = {+greh_castigator_5_dead +greh_castigator_6_dead +greh_sabaoth_dead} complete
condlist_1 = {+stalker_rogue_dead} fail, {+stalker_stitch_dead} fail

;------------------------------------------------
; Mortal Sin Task 19-
[lttz_ms_choice]
icon = ui_iconsTotal_sar_monolith
prior = 195
storyline = true

title = lttz_ms_choice_title
target = {+stalker_stitch_mortal_sin_wishful_thinking} sar_monolith, stalker_stitch
descr = {+stalker_stitch_mortal_sin_wishful_thinking} lttz_ms_choice_descr2, lttz_ms_choice_descr
status_functor = special_steps_for_lostzone_tasks
stage_complete = 2

on_complete = %=remove_special_task_squad(stalker_stitch) =remove_special_task_squad(stalker_rogue) +mortal_sin_choice%
condlist_0 = {+deny_the_wish} complete, {+actor_made_wish} complete
condlist_1 = {+stalker_rogue_dead} fail, {+stalker_stitch_dead} fail

;------------------------------------------------
; Mortal Sin Task 20-
[lttz_ms_zone_hero_dolg]
icon = ui_iconsNpc_stalker_do_komandir
prior = 195
storyline = true

title = lttz_ms_zone_hero_title
target = bar_dolg_leader
descr = lttz_ms_zone_hero_dolg_descr
status_functor = special_steps_for_lostzone_tasks
stage_complete = 3

on_complete = %=reward_item(wpn_pkm_zulus) =reward_money(25000) =complete_task_inc_goodwill(100:dolg) =remove_special_task_squad(lim_dolg_assault_squad)%
condlist_0 = {+mortal_sin_zone_hero} complete

[lttz_ms_zone_hero_killer]
icon = ui_iconsNpc_stalker_ki_informator
prior = 195
storyline = true

title = lttz_ms_zone_hero_title
target = cit_killers_merc_trader_stalker
descr = lttz_ms_zone_hero_killer_descr
status_functor = special_steps_for_lostzone_tasks
stage_complete = 3

on_complete = %=reward_item(wpn_svd_nimble) =reward_money(25000) =complete_task_inc_goodwill(100:killer) =remove_special_task_squad(lim_killer_assault_squad)%
condlist_0 = {+mortal_sin_zone_hero} complete

[lttz_ms_zone_hero_stalker]
icon = ui_iconsNpc_trader
prior = 195
storyline = true

title = lttz_ms_zone_hero_title
target = esc_m_trader
descr = lttz_ms_zone_hero_stalker_descr
status_functor = special_steps_for_lostzone_tasks
stage_complete = 3

on_complete = %=reward_item(af_electra_moonlight) =reward_money(25000) =complete_task_inc_goodwill(100:stalker) =remove_special_task_squad(lim_stalker_assault_squad)%
condlist_0 = {+mortal_sin_zone_hero} complete

[lttz_ms_zone_hero_csky]
icon = ui_inGame2_Put_v_pripyat
prior = 195
storyline = true

title = lttz_ms_zone_hero_title
target = mar_smart_terrain_base_stalker_leader_marsh
descr = lttz_ms_zone_hero_csky_descr
status_functor = special_steps_for_lostzone_tasks
stage_complete = 3

on_complete = %=reward_item(af_surge_up) =reward_item(af_kevlar_up) =reward_money(25000) =complete_task_inc_goodwill(100:csky) =remove_special_task_squad(lim_csky_assault_squad)%
condlist_0 = {+mortal_sin_zone_hero} complete

[lttz_ms_zone_hero_freedom]
icon = ui_iconsNpc_stalker_sv_leader
prior = 195
storyline = true

title = lttz_ms_zone_hero_title
target = mil_smart_terrain_7_7_freedom_leader_stalker
descr = lttz_ms_zone_hero_freedom_descr
status_functor = special_steps_for_lostzone_tasks
stage_complete = 3

on_complete = %=reward_item(wpn_svu) =reward_item(cocaine) =reward_money(20000) =complete_task_inc_goodwill(100:freedom) =remove_special_task_squad(lim_freedom_assault_squad)%
condlist_0 = {+mortal_sin_zone_hero} complete

[lttz_ms_zone_hero_ecolog]
icon = ui_iconsNpc_ucheniy_2
prior = 195
storyline = true

title = lttz_ms_zone_hero_title
target = yan_stalker_sakharov
descr = lttz_ms_zone_hero_ecolog_descr
status_functor = special_steps_for_lostzone_tasks
stage_complete = 3

on_complete = %=reward_item(stimpack_scientic) =reward_money(25000) =complete_task_inc_goodwill(100:ecolog) =remove_special_task_squad(lim_ecolog_assault_squad)%
condlist_0 = {+mortal_sin_zone_hero} complete
